<!DOCTYPE html>
<html>
<head>
    <title>Ghost Freak Mobile</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body { margin: 0; overflow: hidden; background: black; font-family: sans-serif; }
        #ui { position: absolute; top: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; color: red; z-index: 10; }
        #controls { position: absolute; bottom: 20px; width: 100%; display: flex; justify-content: space-around; z-index: 5; pointer-events: none; }
        .btn { width: 60px; height: 60px; background: rgba(255,255,255,0.2); color: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; pointer-events: auto; user-select: none; }
        #win-screen { display: none; position: absolute; top:0; width:100%; height:100%; background:black; color:gold; justify-content:center; align-items:center; flex-direction:column; z-index:20; }
    </style>
</head>
<body>

    <div id="ui">
        <h1>GHOST FREAK HORROR</h1>
        <button id="start-btn" style="padding: 20px 40px; background: red; color: white; border: none; font-size: 20px;">START</button>
    </div>

    <div id="win-screen">
        <h1>CONGRATS</h1>
        <p>You escaped Ghost Freak!</p>
    </div>

    <div id="controls">
        <div class="btn" id="btn-left">←</div>
        <div class="btn" id="btn-up">↑</div>
        <div class="btn" id="btn-down">↓</div>
        <div class="btn" id="btn-right">→</div>
        <div class="btn" id="btn-punch" style="background: red;">PUNCH</div>
    </div>

    <script type="importmap">
        { "imports": { "three": "https://unpkg.com" } }
    </script>

    <script type="module">
        import * as THREE from 'three';

        // --- SETUP ---
        const scene = new THREE.Scene();
        scene.fog = new THREE.Fog(0x000000, 1, 15);
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // --- PLAYER & GHOST ---
        const player = new THREE.Group();
        player.position.set(0, 1, 5);
        scene.add(player);

        const demonGeo = new THREE.BoxGeometry(1.2, 2.5, 1.2);
        const demonMat = new THREE.MeshBasicMaterial({ color: 0x888888 });
        const demon = new THREE.Mesh(demonGeo, demonMat);
        demon.position.set(20, 1.25, 0);
        scene.add(demon);

        // --- ROOMS ---
        const floorGeo = new THREE.PlaneGeometry(200, 200);
        const floorMat = new THREE.MeshBasicMaterial({ color: 0x111111 });
        const floor = new THREE.Mesh(floorGeo, floorMat);
        floor.rotation.x = -Math.PI / 2;
        scene.add(floor);

        // --- MOVEMENT LOGIC ---
        let move = { fwd: 0, lat: 0 };
        let gameRunning = false;

        document.getElementById('start-btn').onclick = () => {
            document.getElementById('ui').style.display = 'none';
            gameRunning = true;
        };

        const setupBtn = (id, axis, val) => {
            const el = document.getElementById(id);
            el.ontouchstart = () => move[axis] = val;
            el.ontouchend = () => move[axis] = 0;
        };

        setupBtn('btn-up', 'fwd', 0.1);
        setupBtn('btn-down', 'fwd', -0.1);
        setupBtn('btn-left', 'lat', -0.1);
        setupBtn('btn-right', 'lat', 0.1);

        document.getElementById('btn-punch').ontouchstart = () => {
            if(player.position.distanceTo(demon.position) < 4) {
                gameRunning = false;
                document.getElementById('win-screen').style.display = 'flex';
            }
        };

        // --- GAME LOOP ---
        function animate() {
            requestAnimationFrame(animate);
            if (!gameRunning) return;

            // Player Move
            player.position.z -= move.fwd;
            player.position.x += move.lat;
            camera.position.copy(player.position);

            // Ghost Chase
            demon.lookAt(player.position);
            const direction = new THREE.Vector3().subVectors(player.position, demon.position).normalize();
            demon.position.add(direction.multiplyScalar(0.04));

            // Collision
            if (player.position.distanceTo(demon.position) < 1.5) {
                player.position.set(0, 1, 5); // Reset
            }

            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
